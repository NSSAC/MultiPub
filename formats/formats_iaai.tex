% formats/formats_iaai.tex
% IAAI/AAAI formatting using authors_db.tex, with simple selection.
%
% Requires in main_iaai.tex:
%   \usepackage{etoolbox}
%   \input{authors_db}
%   \newcommand{\SelectedAuthors}{1,2,3,4}  % CSV, no spaces, no trailing comma
%
% Requires in authors_db.tex:
%   \providecommand{\OneAuthor}[7]{}        % no-op default
%   \newcommand{\AllAuthorData}{...}        % your existing author data

% ---------- Helper: is an author ID selected? ----------
% Usage: \IfAuthorSelected{<id>}{<code if yes>}{<code if no>}
\newcommand{\IfAuthorSelected}[3]{%
  \def\ResultFlag{0}%
  \def\TargetID{#1}%
  \def\do##1{%
    \def\CurrentID{##1}%
    \ifx\CurrentID\TargetID
      \def\ResultFlag{1}%
    \fi
  }%
  \expandafter\docsvlist\expandafter{\SelectedAuthors}%
  \ifnum\ResultFlag=1
    #2%
  \else
    #3%
  \fi
}

% ---------- Author line with superscripts ----------
% #1 = ID
% #2 = name
% #3 = affiliation index string (e.g. "1" or "1,2")

\newcommand{\iaaiauthorlist}{%
  \renewcommand{\OneAuthor}[7]{%
    \IfAuthorSelected{##1}{%
      ##2\textsuperscript{\rm ##3}, %
    }{}%
  }%
  \AllAuthorData
}

% ---------- Affiliations block ----------
% For simplicity, repeat affiliation text per selected author.
% #3 = affiliation index string
% #4 = full affiliation text

\newcommand{\iaaiaffilblock}{%
  \renewcommand{\OneAuthor}[7]{%
    \IfAuthorSelected{##1}{%
      \textsuperscript{\rm ##3}##4\\%
    }{}%
  }%
  \AllAuthorData
}

% ---------- Single public command ----------

\newcommand{\iaaiauthorsaffiliations}{%
  \author{\iaaiauthorlist\\}%
  \affiliations{\iaaiaffilblock}%
}
